<div class="user">
    <div class="togelbar">
      <div class="toglebarcontainer">
        <div class="toglebarcontainer2" *ngFor="let salle of displayedSalle">
          <img [src]="salle.image" alt="{{ salle.name }}" class="img1">
        </div>
        <div>
          <div style="position: absolute;left: 282px;top: 15px;">
            <input class="in22" type="text" [(ngModel)]="query" (keyup.enter)="search()"
              placeholder="Enter your search...">
            <i class='bx bx-search-alt'
              style="font-size: 19px;line-height: 38px;position: absolute;left: 13px;cursor: pointer;"></i>
          </div>
          <button class="bb2" (click)="toggleDropdown2()" style="position: relative;">
            <span class="bb2s"> {{ countAcceptedEvents }}</span>
            <div class="ii">
              <i class='bx bx-bell' style="font-size: 22px;"></i>
            </div>
          </button>
          <div class="dropdown-menu" *ngIf="showDropdown2" style="right: 228px;    width: 318px ">
            <!-- Contenu de votre menu déroulant -->
            <div class="nottit">
              <div style="width: 222px;">
                <h6> notification</h6>
              </div>
              <div style="padding: 0px 12px;width: 63px;">
                <a href="" class="dd">Vieux all</a>
              </div>
            </div>
            <div style="display: block;" *ngFor="let event of lastAcceptedEvent">
              <div class="ev">
                <div class="im">
                  <img [src]="event.user.image" alt="Image de l'événement" class="ivim">
                </div>
                <div>
                  <h6 class="hh6">{{ event.user.username }}</h6>
                  <a href="" style="text-decoration: none;" [routerLink]="['/eventid', event.id]">
                    <p class="pp">{{ event.nom }}</p>
                  </a>
                  <p class="pp"><i class="fa-regular fa-clock" style="animation: none;font-size: 12px; "></i>
                    {{ event.timeAgo }}
                  </p>
                </div>
              </div>
            </div>
            <div class="foot">
              <a href="" style="font-size: 14px ;text-decoration: none;" class="dd"> Vieux more...</a>
            </div>
          </div>
          <div *ngIf="userInfo" style="display: inline-block;">
            <img [src]="userInfo.image" alt="User Image" class="img2">
          </div>
          <div class="b2" *ngIf="userInfo">
            <button class="bb2" (click)="toggleDropdown()">
  
              <p>{{ userInfo.username }}</p>
              <span><i class="fas fa-angle-down icon2"></i></span>
            </button>
            <div class="dropdown-menu dropdown-menu-end" *ngIf="showDropdown">
              <!-- Contenu de votre menu déroulant -->
              <a href="" class="a1" [routerLink]="['/user',userInfo.id]">
                <i class='bx bx-user'></i>
                profile</a>
              <a [routerLink]="['/updateuser',userInfo.id]" class="a1"><i class='bx bx-wrench'></i>my information</a>
              <a [routerLink]="['/ibm',userInfo.id]" class="a1"><i class='bx bx-dumbbell'></i>my IBM</a>
              <a [routerLink]="['/qrcode',userInfo.id]" class="a1"><i class='bx bx-qr'></i>my QRcode</a>

            </div>
          </div>
          <button class="b">
            <i class='bx bx-cog'></i>
          </button>
  
  
        </div>
      </div>
    </div>
  
  </div>
  <div style="display: flex;">
    <div style="position: relative;top: 70px;">
      <app-baradus></app-baradus>
    </div>
    <div class="ss" *ngIf="userInfo2">
      <div class="ss1">
        <h4>chat</h4>
        <span style="display: flex;">
          <p style="margin-right: 10px;">chat</p>/ <p class="pps">Chat</p>
        </span>
      </div>
      <div class="ss2">
        <div class="ss4">
          <div class="ss3">
            <img [src]="userInfo.image" alt="User Image">
            <div style="display: block;">
              <h5>{{userInfo.username}}</h5>
              <p><i class="fa-solid fa-circle" style="color: rgba(52, 195, 143);margin-right: 5px;"></i> active</p>
            </div>
          </div>
          <div class="ss32">
            <input type="text" [(ngModel)]="query2" name="query2" placeholder="Search..." (input)="searchuser()"
              class="in22s">
            <i class='bx bx-search-alt'
              style="font-size: 19px;line-height: 38px;position: absolute;left: 15px;cursor: pointer;"></i>
          </div>
          <div class="ss32s">
            <h5>Recent</h5>
            <div>
              <div>
                <!-- user-list.component.html -->
                <div class="scroll-container" style="width: 380px;">
                  <div class="content">
                    <!-- Afficher les résultats de la recherche -->
                    <ng-container *ngIf="query2.trim() !== ''">
                      <div *ngFor="let result of searchResults2">
                        <a class="aa2">
                          <div style="display: flex;">
                            <p *ngIf="result.isConnected; else notConnectedMessage">
                              <i class="fa-solid fa-circle"
                                style="color: green; font-size:10px;margin-right: 10px; margin-top: 10px;"></i>
                            </p>
                            <ng-template #notConnectedMessage>
                              <i class="fa-solid fa-circle"
                                style="color: red; font-size:10px;margin-right: 10px; margin-top: 10px;"></i>
                            </ng-template>
                            <img [src]="result.image" alt="User Image" class="usim">
                            <a    [routerLink]="['/chat', userInfo.id, userInfo2.id]" style="text-decoration: none;    color: #c3cbe4; cursor: pointer;"><h3>{{ result.username }}</h3></a>  
                          </div>
                        </a>
                      </div>
                    </ng-container>
                    <!-- Afficher la liste des utilisateurs par défaut -->
                    <ng-container *ngIf="query2.trim() === ''">
                      <div *ngFor="let user of usersAndCoaches">
                        <a class="aa2">
                          <div style="display: flex;">
                            <p *ngIf="user.isConnected; else notConnectedMessage">
                              <i class="fa-solid fa-circle"
                                style="color: green; font-size:10px;margin-right: 10px; margin-top: 10px;"></i>
                            </p>
                            <ng-template #notConnectedMessage>
                              <i class="fa-solid fa-circle"
                                style="color: red; font-size:10px;margin-right: 10px; margin-top: 10px;"></i>
                            </ng-template>
                            <img [src]="user.image" alt="User Image" class="usim">
                            <a [routerLink]="['/chat', userInfo.id, userInfo2.id]" style="text-decoration: none; cursor: pointer;    color: #c3cbe4;"><h3>{{ user.username }}</h3></a>  
                          </div>
                        </a>
                      </div>
                    </ng-container>
                  </div>
                </div>
  
              </div>
            </div>
  
          </div>
            <div>
            </div>
          </div>
         <div class="card1" *ngIf="userInfo2">
           <div class="card2">
           <div style="display: flex;align-items: center;justify-content: space-between;">
            <div style="display: block;">
              <h5>{{ userInfo2.username }}</h5>
              <p><i class="fa-solid fa-circle" style="color: rgba(52, 195, 143);margin-right: 5px;"></i> Active now</p>
            </div>
           <div>
            <i class='bx bx-cog' style="font-size:25px;color: #c3cbe4;cursor: pointer;" (click)="toggleDropdown4()"></i>
            <div *ngIf="showDropdown4" class="drop2">
              <!-- Contenu de votre dropdown -->
          <a [routerLink]="['/useridd', userInfo.id, userInfo2.id]">View Profile</a>
            </div>
  
  
  
  
           </div>
           </div>
  
           </div>
  <div class="scroll-container2">
    <div class="content2">
      <ng-container >
        <!-- Affichage des messages -->
        <div *ngFor="let message of messages" >
        <div class="messagemoi">
          <h1>{{ userInfo.username }}</h1>
          <p style="margin-bottom: 16px;">{{ message.content }}</p>
          <p><i class='bx bx-time-five' style="margin-right: 5px;"></i>{{ formatTime(message.addedDate)}}</p>
        </div>
  
        </div>
        <div *ngFor="let message of messagesss" >
          <div class="messagemoi2">
            <h1>{{ userInfo2.username }}</h1>
            <p>{{ message.content }}</p>
            <p style="margin-bottom: 16px;">{{ message.content }}</p>
            <p><i class='bx bx-time-five' style="margin-right: 5px;"></i>{{ formatTime(message.addedDate)}}</p>
          </div>
         
        </div>
      </ng-container>
  
    </div>
    
  </div>
  <div class="innf">
     
    <textarea [(ngModel)]="messageContent" placeholder="Enter your message"></textarea>
    <button (click)="sendMessage(userInfo.id, userInfo2.id)" class="send"><span>send</span> <i class='bx bx-send' ></i></button>
  
  </div>
    
          
         </div>
  
         <div *ngIf="searchResults.length > 0" class="bb2b" (click)="toggleDropdown3()">
          <div class="bb21">
              <h1>search result</h1>
         </div>
          <div style="display: flex;" *ngFor="let result of searchResults">
  
              <img [src]="result.image" alt="Image">
              <div class="evv3">
                  <a href="" [routerLink]="['/initlest', userInfo.id, result.id]">{{ result.nom }} </a>
                  <a href="" [routerLink]="['/inscriptioncour', userInfo.id, result.id]">{{ result.name }}</a>
                  {{ result.username }}
              </div>
          </div>
      </div>
        </div>
        <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />